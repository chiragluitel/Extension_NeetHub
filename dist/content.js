console.log("NeetHub Content Script Loaded!");const a="neethub-push-button";function y(){if(document.getElementById(a)){console.log("NeetHub button already exists.");return}const t=document.querySelector(".flex.items-center.justify-between.gap-4")||document.querySelector('div[class*="result-"] > div > div');if(!t){console.warn("NeetHub: Could not find target container to inject button.");return}const e=document.createElement("button");e.id=a,e.textContent="Push to GitHub",e.style.marginLeft="10px",e.style.padding="5px 10px",e.style.backgroundColor="#2a9d8f",e.style.color="white",e.style.border="none",e.style.borderRadius="4px",e.style.cursor="pointer",e.style.fontSize="14px",e.addEventListener("click",x),t.appendChild(e),console.log("NeetHub button added.")}function x(){var e,l,s;const t=document.getElementById(a);if(!(!t||t.disabled)){console.log("NeetHub: Push button clicked!"),t.textContent="Pushing...",t.disabled=!0,t.style.backgroundColor="#aaa";try{const n=document.querySelector('h3 a[href*="/problems/"]')||document.querySelector("h4.break-words");let i=((e=n==null?void 0:n.textContent)==null?void 0:e.trim())??"Unknown Problem";i=i.replace(/^\d+\.\s*/,"");const b=window.location.pathname.split("/"),h=b[b.length-1]||i.toLowerCase().replace(/\s+/g,"-"),d=document.querySelector('button[id^="headlessui-listbox-button"] > span')||document.querySelector(".relative > button > span"),f=((s=(l=d==null?void 0:d.textContent)==null?void 0:l.trim())==null?void 0:s.toLowerCase())??"unknown",p=C(f);let c="";const g=document.querySelectorAll(".view-lines .view-line span");if(g.length>0){let o="";g.forEach(u=>{o+=u.textContent||""});const r=document.querySelectorAll(".view-lines .view-line");if(r.length>0)c=Array.from(r).map(u=>u.innerText||"").join(`
`);else{const u=document.querySelector(".monaco-editor")||document.querySelector('div[class*="language-"]');c=u?u.innerText:"// NeetHub: Could not automatically extract code."}}else{const o=document.querySelector('textarea[aria-label*="solution"]'),r=document.querySelector('code[class*="language-"]');o?c=o.value:r?c=r.innerText:c="// NeetHub: Could not automatically extract code."}const m={problemTitle:i,problemSlug:h,language:f,fileExtension:p,code:c,sourceUrl:window.location.href};console.log("NeetHub: Sending data to background:",m),chrome.runtime.sendMessage({type:"PUSH_CODE_TO_GITHUB",data:m},o=>{var r;if(chrome.runtime.lastError){console.error("NeetHub: Error sending message:",chrome.runtime.lastError.message),t.textContent="Error (See Console)",t.style.backgroundColor="#d9534f";return}o&&o.success?(console.log("NeetHub: Push successful!",o.url),t.textContent="Pushed!",t.style.backgroundColor="#5cb85c",o.url&&(t.onclick=()=>window.open(o.url,"_blank"),t.style.cursor="pointer")):(console.error("NeetHub: Push failed.",o==null?void 0:o.error),t.textContent=`Error: ${((r=o==null?void 0:o.error)==null?void 0:r.slice(0,30))||"Failed"}`,t.style.backgroundColor="#d9534f")})}catch(n){console.error("NeetHub: Error extracting data:",n),t.textContent="Error Extracting Data",t.disabled=!1,t.style.backgroundColor="#d9534f"}}}function C(t){const e=t.toLowerCase();return e.includes("python")?"py":e.includes("javascript")?"js":e.includes("typescript")?"ts":e.includes("java")?"java":e.includes("c++")||e.includes("cpp")?"cpp":e.includes("c#")||e.includes("csharp")?"cs":e.includes("go")?"go":e.includes("ruby")?"rb":e.includes("swift")?"swift":e.includes("kotlin")?"kt":e.includes("rust")?"rs":e.includes("php")?"php":e.includes("scala")?"scala":"txt"}const w=new MutationObserver((t,e)=>{for(const l of t)if(l.type==="childList"||l.type==="attributes"){const s=document.querySelector("span.text-green-500")||document.querySelector('div[class*="success"]'),n=document.querySelector(".monaco-editor")||document.querySelector('div[class*="language-"]');if(s&&n){console.log("NeetHub: Detected successful submission state."),y();return}s&&n&&!document.getElementById(a)&&(console.log("NeetHub: Re-adding button after DOM change."),y())}});w.observe(document.body,{childList:!0,subtree:!0});
